require 'gemini-ai'

class GeminiHandler   

  def self.call(*args)
    new(*args).call
  end

  def initialize(model = 'gemini-pro', service = 'vertex-ai-api')

    # With Application Default Credentials
    @client = Gemini.new(
        credentials: {
            service: service,
            region: 'us-east4'
        },
        options: { model: model, server_sent_events: true }
    )
  end

  def call(text, role = 'user')
    result = client.stream_generate_content({
      contents: { role: role, parts: { text: text } }
    })
  end

  private
  
  
end
